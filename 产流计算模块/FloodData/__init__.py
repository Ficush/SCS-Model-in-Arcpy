# -*- coding: utf-8 -*-

# 导入模块
import xlrd

# 洪水代号
floodSymbol = {
    "Y2012M04D23":"A",
    "Y2012M05D01":"B",
    "Y2012M05D14":"C",
    "Y2012M06D10":"D",
    "Y2012M08D03":"E",
    "Y2013M08D22":"F",
    "Y2015M05D19":"G",
    "Y2015M05D26":"H",
    "Y2015M07D03":"I"
}

# 土壤湿度数据
floodSoilType = {
    "Y2012M04D23":"S2",
    "Y2012M05D01":"S2",
    "Y2012M05D14":"S3",
    "Y2012M06D10":"S2",
    "Y2012M08D03":"S2",
    "Y2013M08D22":"S1",
    "Y2015M05D19":"S2",
    "Y2015M05D26":"S2",
    "Y2015M07D03":"S1"
}

# 洪水时间数据
floodList = {
    "Y2015M05D19":[
        "Y2015M5D19T0",
        "Y2015M5D19T1",
        "Y2015M5D19T2",
        "Y2015M5D19T3",
        "Y2015M5D19T4",
        "Y2015M5D19T5",
        "Y2015M5D19T6",
        "Y2015M5D19T7",
        "Y2015M5D19T8",
        "Y2015M5D19T9",
        "Y2015M5D19T10",
        "Y2015M5D19T11",
        "Y2015M5D19T12",
        "Y2015M5D19T13",
        "Y2015M5D19T14",
        "Y2015M5D19T15",
        "Y2015M5D19T16",
        "Y2015M5D19T17",
        "Y2015M5D19T18",
        "Y2015M5D19T19",
        "Y2015M5D19T20",
        "Y2015M5D19T21",
        "Y2015M5D19T22",
        "Y2015M5D19T23",
        "Y2015M5D20T0",
        "Y2015M5D20T1",
        "Y2015M5D20T2",
        "Y2015M5D20T3",
        "Y2015M5D20T4",
        "Y2015M5D20T5",
        "Y2015M5D20T6",
        "Y2015M5D20T7",
        "Y2015M5D20T8",
        "Y2015M5D20T9",
        "Y2015M5D20T10",
        "Y2015M5D20T11",
        "Y2015M5D20T12",
        "Y2015M5D20T13",
        "Y2015M5D20T14",
        "Y2015M5D20T15",
        "Y2015M5D20T16"
    ],

    "Y2012M05D01":[
        "Y2012M5D1T19",
        "Y2012M5D1T20",
        "Y2012M5D1T21",
        "Y2012M5D1T22",
        "Y2012M5D1T23",
        "Y2012M5D2T0",
        "Y2012M5D2T1",
        "Y2012M5D2T2",
        "Y2012M5D2T3",
        "Y2012M5D2T4",
        "Y2012M5D2T5",
        "Y2012M5D2T6",
        "Y2012M5D2T7",
        "Y2012M5D2T8",
        "Y2012M5D2T9"
    ],

    "Y2012M06D10":[
        "Y2012M6D09T9",
        "Y2012M6D09T10",
        "Y2012M6D09T11",
        "Y2012M6D09T12",
        "Y2012M6D09T13",
        "Y2012M6D09T14",
        "Y2012M6D09T15",
        "Y2012M6D09T16",
        "Y2012M6D09T17",
        "Y2012M6D09T18",
        "Y2012M6D09T19",
        "Y2012M6D09T20",
        "Y2012M6D09T21",
        "Y2012M6D09T22",
        "Y2012M6D09T23",
        "Y2012M6D10T0",
        "Y2012M6D10T1",
        "Y2012M6D10T2",
        "Y2012M6D10T3",
        "Y2012M6D10T4",
        "Y2012M6D10T5",
        "Y2012M6D10T6",
        "Y2012M6D10T7",
        "Y2012M6D10T8",
        "Y2012M6D10T9",
        "Y2012M6D10T10",
        "Y2012M6D10T11",
        "Y2012M6D10T12",
        "Y2012M6D10T13",
        "Y2012M6D10T14",
        "Y2012M6D10T15",
        "Y2012M6D10T16",
        "Y2012M6D10T17",
        "Y2012M6D10T18",
        "Y2012M6D10T19",
        "Y2012M6D10T20",
        "Y2012M6D10T21",
        "Y2012M6D10T22",
        "Y2012M6D10T23",
        "Y2012M6D11T0",
        "Y2012M6D11T1",
        "Y2012M6D11T2",
        "Y2012M6D11T3",
        "Y2012M6D11T4",
        "Y2012M6D11T5",
        "Y2012M6D11T6",
        "Y2012M6D11T7",
        "Y2012M6D11T8",
        "Y2012M6D11T9",
        "Y2012M6D11T10",
        "Y2012M6D11T11",
        "Y2012M6D11T12",
        "Y2012M6D11T13",
        "Y2012M6D11T14",
        "Y2012M6D11T15",
        "Y2012M6D11T16",
        "Y2012M6D11T17",
        "Y2012M6D11T18",
        "Y2012M6D11T19",
        "Y2012M6D11T20",
        "Y2012M6D11T21",
        "Y2012M6D11T22",
        "Y2012M6D11T23",
        "Y2012M6D12T0",
        "Y2012M6D12T1",
        "Y2012M6D12T2",
        "Y2012M6D12T3",
        "Y2012M6D12T4",
        "Y2012M6D12T5",
        "Y2012M6D12T6",
        "Y2012M6D12T7",
        "Y2012M6D12T8"
    ],

    "Y2012M04D23":[
        "Y2012M4D23T18",
        "Y2012M4D23T19",
        "Y2012M4D23T20",
        "Y2012M4D23T21",
        "Y2012M4D23T22",
        "Y2012M4D23T23",
        "Y2012M4D24T0",
        "Y2012M4D24T1",
        "Y2012M4D24T2",
        "Y2012M4D24T3",
        "Y2012M4D24T4",
        "Y2012M4D24T5",
        "Y2012M4D24T6",
        "Y2012M4D24T7",
        "Y2012M4D24T8",
        "Y2012M4D24T9",
        "Y2012M4D24T10",
        "Y2012M4D24T11",
        "Y2012M4D24T12",
        "Y2012M4D24T13",
        "Y2012M4D24T14",
        "Y2012M4D24T15",
        "Y2012M4D24T16",
        "Y2012M4D24T17",
        "Y2012M4D24T18",
        "Y2012M4D24T19",
        "Y2012M4D24T20",
        "Y2012M4D24T21",
        "Y2012M4D24T22",
        "Y2012M4D24T23",
        "Y2012M4D25T0",
        "Y2012M4D25T1",
        "Y2012M4D25T2",
        "Y2012M4D25T3",
        "Y2012M4D25T4",
        "Y2012M4D25T5",
        "Y2012M4D25T6",
        "Y2012M4D25T7",
        "Y2012M4D25T8",
        "Y2012M4D25T9",
        "Y2012M4D25T10",
        "Y2012M4D25T11",
        "Y2012M4D25T12",
        "Y2012M4D25T13",
        "Y2012M4D25T14",
        "Y2012M4D25T15",
        "Y2012M4D25T16",
        "Y2012M4D25T17",
        "Y2012M4D25T18",
        "Y2012M4D25T19",
        "Y2012M4D25T20",
        "Y2012M4D25T21",
        "Y2012M4D25T22",
        "Y2012M4D25T23"
    ],

    "Y2012M05D14":[
        "Y2012M5D13T4",
        "Y2012M5D13T5",
        "Y2012M5D13T6",
        "Y2012M5D13T7",
        "Y2012M5D13T8",
        "Y2012M5D13T9",
        "Y2012M5D13T10",
        "Y2012M5D13T11",
        "Y2012M5D13T12",
        "Y2012M5D13T13",
        "Y2012M5D13T14",
        "Y2012M5D13T15",
        "Y2012M5D13T16",
        "Y2012M5D13T17",
        "Y2012M5D13T18",
        "Y2012M5D13T19",
        "Y2012M5D13T20",
        "Y2012M5D13T21",
        "Y2012M5D13T22",
        "Y2012M5D13T23",
        "Y2012M5D14T0",
        "Y2012M5D14T1",
        "Y2012M5D14T2",
        "Y2012M5D14T3",
        "Y2012M5D14T4",
        "Y2012M5D14T5",
        "Y2012M5D14T6",
        "Y2012M5D14T7",
        "Y2012M5D14T8",
        "Y2012M5D14T9",
        "Y2012M5D14T10",
        "Y2012M5D14T11",
        "Y2012M5D14T12",
        "Y2012M5D14T13",
        "Y2012M5D14T14",
        "Y2012M5D14T15",
        "Y2012M5D14T16",
        "Y2012M5D14T17",
        "Y2012M5D14T18",
        "Y2012M5D14T19",
        "Y2012M5D14T20",
        "Y2012M5D14T21",
        "Y2012M5D14T22",
        "Y2012M5D14T23",
        "Y2012M5D15T0",
        "Y2012M5D15T1",
        "Y2012M5D15T2",
        "Y2012M5D15T3",
        "Y2012M5D15T4",
        "Y2012M5D15T5",
        "Y2012M5D15T6",
        "Y2012M5D15T7",
        "Y2012M5D15T8",
        "Y2012M5D15T9",
        "Y2012M5D15T10",
        "Y2012M5D15T11",
        "Y2012M5D15T12",
        "Y2012M5D15T13",
        "Y2012M5D15T14",
        "Y2012M5D15T15",
        "Y2012M5D15T16",
        "Y2012M5D15T17",
        "Y2012M5D15T18",
        "Y2012M5D15T19",
        "Y2012M5D15T20",
        "Y2012M5D15T21"
    ],

    "Y2015M05D26":[
        "Y2015M5D26T1",
        "Y2015M5D26T2",
        "Y2015M5D26T3",
        "Y2015M5D26T4",
        "Y2015M5D26T5",
        "Y2015M5D26T6",
        "Y2015M5D26T7",
        "Y2015M5D26T8",
        "Y2015M5D26T9",
        "Y2015M5D26T10",
        "Y2015M5D26T11",
        "Y2015M5D26T12",
        "Y2015M5D26T13",
        "Y2015M5D26T14",
        "Y2015M5D26T15",
        "Y2015M5D26T16",
        "Y2015M5D26T17",
        "Y2015M5D26T18",
        "Y2015M5D26T19",
        "Y2015M5D26T20"
    ],

    "Y2012M08D03":[
        "Y2012M8D3T0",
        "Y2012M8D3T1",
        "Y2012M8D3T2",
        "Y2012M8D3T3",
        "Y2012M8D3T4",
        "Y2012M8D3T5",
        "Y2012M8D3T6",
        "Y2012M8D3T7",
        "Y2012M8D3T8",
        "Y2012M8D3T9",
        "Y2012M8D3T10",
        "Y2012M8D3T11",
        "Y2012M8D3T12",
        "Y2012M8D3T13",
        "Y2012M8D3T14",
        "Y2012M8D3T15",
        "Y2012M8D3T16",
        "Y2012M8D3T17",
        "Y2012M8D3T18",
        "Y2012M8D3T19",
        "Y2012M8D3T20",
        "Y2012M8D3T21",
        "Y2012M8D3T22",
        "Y2012M8D3T23",
        "Y2012M8D4T0",
        "Y2012M8D4T1",
        "Y2012M8D4T2",
        "Y2012M8D4T3",
        "Y2012M8D4T4",
        "Y2012M8D4T5",
        "Y2012M8D4T6",
        "Y2012M8D4T7",
        "Y2012M8D4T8",
        "Y2012M8D4T9",
        "Y2012M8D4T10",
        "Y2012M8D4T11",
        "Y2012M8D4T12",
        "Y2012M8D4T13",
        "Y2012M8D4T14",
        "Y2012M8D4T15",
        "Y2012M8D4T16",
        "Y2012M8D4T17",
        "Y2012M8D4T18",
        "Y2012M8D4T19",
        "Y2012M8D4T20",
        "Y2012M8D4T21",
        "Y2012M8D4T22",
        "Y2012M8D4T23"
    ],

    "Y2013M08D22":[
        "Y2013M8D22T3",
        "Y2013M8D22T4",
        "Y2013M8D22T5",
        "Y2013M8D22T6",
        "Y2013M8D22T7",
        "Y2013M8D22T8",
        "Y2013M8D22T9",
        "Y2013M8D22T10",
        "Y2013M8D22T11",
        "Y2013M8D22T12",
        "Y2013M8D22T13",
        "Y2013M8D22T14",
        "Y2013M8D22T15",
        "Y2013M8D22T16",
        "Y2013M8D22T17",
        "Y2013M8D22T18",
        "Y2013M8D22T19",
        "Y2013M8D22T20",
        "Y2013M8D22T21",
        "Y2013M8D22T22",
        "Y2013M8D22T23",
        "Y2013M8D23T0",
        "Y2013M8D23T1",
        "Y2013M8D23T2",
        "Y2013M8D23T3",
        "Y2013M8D23T4",
        "Y2013M8D23T5",
        "Y2013M8D23T6",
        "Y2013M8D23T7",
        "Y2013M8D23T8"
    ],

    "Y2015M07D03":[
        "Y2015M7D3T1",
        "Y2015M7D3T2",
        "Y2015M7D3T3",
        "Y2015M7D3T4",
        "Y2015M7D3T5",
        "Y2015M7D3T6",
        "Y2015M7D3T7",
        "Y2015M7D3T8",
        "Y2015M7D3T9",
        "Y2015M7D3T10",
        "Y2015M7D3T11",
        "Y2015M7D3T12",
        "Y2015M7D3T13",
        "Y2015M7D3T14",
        "Y2015M7D3T15",
        "Y2015M7D3T16",
        "Y2015M7D3T17",
        "Y2015M7D3T18",
        "Y2015M7D3T19",
        "Y2015M7D3T20",
        "Y2015M7D3T21",
        "Y2015M7D3T22",
        "Y2015M7D3T23",
        "Y2015M7D4T0",
        "Y2015M7D4T1"
    ]
}

# 定义洪量数据结构
floodValue = {

}

# 对于每次洪水，载入其流量数据
for floodDate in floodList.keys():

    # 打开存储流量数据的 Excel 表
    if __name__ == "__main__":
        dataExcel = xlrd.open_workbook("dataexcel.xls")
    else:
        dataExcel = xlrd.open_workbook("FloodData\\dataexcel.xls")

    # 尝试读取表格，名称为日期
    try: dataTabel = dataExcel.sheet_by_name(floodDate)

    # 若失败，跳过本循环
    except: continue

    # 获取当次洪水时长
    recordNumber = len(floodList[floodDate]) + 1

    # 定义子字典
    floodValue[floodDate] = {}

    # 按列循环
    for col in range(5):

        # 定义列表
        floodValue[floodDate][col] = []

        # 按行循环
        for row in range(1, recordNumber):            

            # 载入数据
            floodValue[floodDate][col].append(float(dataTabel.cell(row,col).value))


# 汇流时间重分类模板
ReclassFunction = "0 3600 1;" + \
    "3600 7200 2;" + \
    "7200 10800 3;" + \
    "10800 14400 4;" + \
    "14400 18000 5;" + \
    "18000 21600 6;" + \
    "21600 25200 7;" + \
    "25200 28800 8;" + \
    "28800 32400 9;" + \
    "32400 36000 10;" + \
    "36000 39600 11;" + \
    "39600 43200 12;" + \
    "43200 46800 13;" + \
    "46800 50400 14;" + \
    "50400 54000 15;" + \
    "54000 57600 16;" + \
    "57600 61200 17;" + \
    "61200 64800 18;" + \
    "64800 68400 19;" + \
    "68400 72000 20;" + \
    "72000 75600 21;" + \
    "75600 79200 22;" + \
    "79200 82800 23;" + \
    "82800 86400 24;" + \
    "86400 90000 25;" + \
    "90000 93600 26;" + \
    "93600 97200 27;" + \
    "97200 100800 28;" + \
    "100800 104400 29;" + \
    "104400 108000 30;" + \
    "108000 111600 31;" + \
    "111600 115200 32;" + \
    "115200 118800 33;" + \
    "118800 122400 34;" + \
    "122400 126000 35;" + \
    "126000 129600 36;" + \
    "129600 133200 37;" + \
    "133200 136800 38;" + \
    "136800 140400 39;" + \
    "140400 144000 40;" + \
    "144000 147600 41;" + \
    "147600 151200 42;" + \
    "151200 154800 43;" + \
    "154800 158400 44;" + \
    "158400 162000 45;" + \
    "162000 165600 46;" + \
    "165600 169200 47;" + \
    "169200 172800 48;" + \
    "172800 176400 49;" + \
    "176400 180000 50;" + \
    "180000 183600 51;" + \
    "183600 187200 52;" + \
    "187200 190800 53;" + \
    "190800 194400 54;" + \
    "194400 198000 55;" + \
    "198000 201600 56;" + \
    "201600 205200 57;" + \
    "205200 208800 58;" + \
    "208800 212400 59;" + \
    "212400 216000 60;" + \
    "216000 219600 61;" + \
    "219600 223200 62;" + \
    "223200 226800 63;" + \
    "226800 230400 64;" + \
    "230400 234000 65;" + \
    "234000 237600 66;" + \
    "237600 241200 67;" + \
    "241200 244800 68;" + \
    "244800 248400 69;" + \
    "248400 252000 70;" + \
    "252000 255600 71;" + \
    "255600 259200 72;" + \
    "259200 262800 73;" + \
    "262800 266400 74;" + \
    "266400 270000 75;" + \
    "270000 273600 76;" + \
    "273600 277200 77;" + \
    "277200 280800 78;" + \
    "280800 284400 79;" + \
    "284400 288000 80;" + \
    "288000 291600 81;" + \
    "291600 295200 82;" + \
    "295200 298800 83;" + \
    "298800 302400 84;" + \
    "302400 306000 85;" + \
    "306000 309600 86;" + \
    "309600 313200 87;" + \
    "313200 316800 88;" + \
    "316800 320400 89;" + \
    "320400 324000 90;" + \
    "324000 327600 91;" + \
    "327600 331200 92;" + \
    "331200 334800 93;" + \
    "334800 338400 94;" + \
    "338400 342000 95;" + \
    "342000 345600 96;" + \
    "345600 349200 97;" + \
    "349200 352800 98;" + \
    "352800 356400 99;" + \
    "356400 360000 100;" + \
    "360000 363600 101;" + \
    "363600 367200 102;" + \
    "367200 370800 103;" + \
    "370800 374400 104;" + \
    "374400 378000 105;" + \
    "378000 381600 106;" + \
    "381600 385200 107;" + \
    "385200 388800 108;" + \
    "388800 392400 109;" + \
    "392400 396000 110;" + \
    "396000 399600 111;" + \
    "399600 403200 112;" + \
    "403200 406800 113;" + \
    "406800 410400 114;" + \
    "410400 414000 115;" + \
    "414000 417600 116;" + \
    "417600 421200 117;" + \
    "421200 424800 118;" + \
    "424800 428400 119;" + \
    "428400 432000 120;" + \
    "432000 435600 121;" + \
    "435600 439200 122;" + \
    "439200 442800 123;" + \
    "442800 446400 124;" + \
    "446400 450000 125;" + \
    "450000 453600 126;" + \
    "453600 457200 127;" + \
    "457200 460800 128"